import{fH as _,bw as p,ii as q,ig as x,fI as J,b6 as g,ht as B,ij as V,ev as Z,ik as b,dU as d,il as h,b1 as z,dT as D,im as k,dV as W,io as Y,ip as H,iq as K,ir as L,dN as G,fQ as M,e6 as y,is as Q,it as X,c5 as $,eC as F,dL as ee}from"./vendor.47ccae81.js";import{f as w,g as A}from"./projectionSupport.f43af219.js";function $e(e,t){if(!e)return null;const n=t.featureAdapter,{startTimeField:i,endTimeField:r}=e;let s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(i&&r)t.forEach(l=>{const a=n.getAttribute(l,i),u=n.getAttribute(l,r);a==null||isNaN(a)||(s=Math.min(s,a)),u==null||isNaN(u)||(o=Math.max(o,u))});else{const l=i||r;t.forEach(a=>{const u=n.getAttribute(a,l);u==null||isNaN(u)||(s=Math.min(s,u),o=Math.max(o,u))})}return{start:s,end:o}}function we(e,t,n){if(!t||!e)return null;const{startTimeField:i,endTimeField:r}=e;if(!i&&!r)return null;const{start:s,end:o}=t;return s===null&&o===null?null:s===void 0&&o===void 0?re():i&&r?te(n,i,r,s,o):ie(n,i||r,s,o)}function te(e,t,n,i,r){return i!=null&&r!=null?s=>{const o=e.getAttribute(s,t),l=e.getAttribute(s,n);return(o==null||o<=r)&&(l==null||l>=i)}:i!=null?s=>{const o=e.getAttribute(s,n);return o==null||o>=i}:r!=null?s=>{const o=e.getAttribute(s,t);return o==null||o<=r}:void 0}function ie(e,t,n,i){return n!=null&&i!=null&&n===i?r=>e.getAttribute(r,t)===n:n!=null&&i!=null?r=>{const s=e.getAttribute(r,t);return s>=n&&s<=i}:n!=null?r=>e.getAttribute(r,t)>=n:i!=null?r=>e.getAttribute(r,t)<=i:void 0}function re(){return()=>!1}const ne=new _({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),E=Object.freeze({}),U=new p,se=new p,v=new p,I={esriGeometryPoint:h,esriGeometryPolyline:W,esriGeometryPolygon:Y,esriGeometryMultipoint:H};function ve(e,t,n,i=e.hasZ,r=e.hasM){if(g(t))return null;const s=e.hasZ&&i,o=e.hasM&&r;if(n){const l=d(v,t,e.hasZ,e.hasM,"esriGeometryPoint",n,i,r);return h(l,s,o)}return h(t,s,o)}function R(e,t,n,i,r,s,o=t,l=n){const a=t&&o,u=n&&l,c=z(i)?"coords"in i?i:i.geometry:null;if(g(c))return null;if(r){let f=D(se,c,t,n,e,r,o,l);return s&&(f=d(v,f,a,u,e,s)),I[e](f,a,u)}if(s){const f=d(v,c,t,n,e,s,o,l);return I[e](f,a,u)}return k(U,c,t,n,o,l),I[e](U,a,u)}async function Ie(e,t,n){const{outFields:i,orderByFields:r,groupByFieldsForStatistics:s,outStatistics:o}=e;if(i)for(let l=0;l<i.length;l++)i[l]=i[l].trim();if(r)for(let l=0;l<r.length;l++)r[l]=r[l].trim();if(s)for(let l=0;l<s.length;l++)s[l]=s[l].trim();if(o)for(let l=0;l<o.length;l++)o[l].onStatisticField&&(o[l].onStatisticField=o[l].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),oe(e,t,n)}async function oe(e,t,n){if(!e)return null;let{where:i}=e;if(e.where=i=i&&i.trim(),(!i||/^1 *= *1$/.test(i)||t&&t===i)&&(e.where=null),!e.geometry)return e;let r=await le(e);if(e.distance=0,e.units=null,e.spatialRel==="esriSpatialRelEnvelopeIntersects"){const{spatialReference:a}=e.geometry;r=q(r),r.spatialReference=a}e.geometry=r,await w(r.spatialReference,n);const s=(await x(J(r)))[0];if(g(s))throw E;const o=s.toJSON(),l=await A(o,o.spatialReference,n);if(!l)throw E;return l.spatialReference=n,e.geometry=l,e}async function le(e){const{geometry:t,distance:n,units:i}=e;if(n==null||"vertexAttributes"in t)return t;const r=t.spatialReference,s=i?ne.fromJSON(i):B(r),o=r&&(V(r)||Z(r))?t:await w(r,b).then(()=>A(t,b));return(await ae())(o.spatialReference,o,n,s)}async function ae(){return(await import("./geometryEngineJSON.54e2870f.js")).geodesicBuffer}function Ne(e){return e&&j in e?JSON.parse(JSON.stringify(e,ue)):e}const j="_geVersion",ue=(e,t)=>e!==j?t:void 0;function ce(e){return e==="mesh"?K:L(e)}function T(e,t){return e?t?4:3:t?3:2}function fe(e,t,n,i){return O(e,t,n,i.coords[0],i.coords[1])}function pe(e,t,n,i,r,s){const o=T(r,s),{coords:l,lengths:a}=i;if(!a)return!1;for(let u=0,c=0;u<a.length;u++,c+=o)if(!O(e,t,n,l[c],l[c+1]))return!1;return!0}function O(e,t,n,i,r){if(!e)return!1;const s=T(t,n),{coords:o,lengths:l}=e;let a=!1,u=0;for(const c of l)a=me(a,o,s,u,c,i,r),u+=c*s;return a}function me(e,t,n,i,r,s,o){let l=e,a=i;for(let u=i,c=i+r*n;u<c;u+=n){a=u+n,a===c&&(a=i);const f=t[u],m=t[u+1],C=t[a],S=t[a+1];(m<o&&S>=o||S<o&&m>=o)&&f+(o-m)/(S-m)*(C-f)<s&&(l=!l)}return l}const N="feature-store:unsupported-query",ye={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},P={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function Re(e){return P.spatialRelationship[e]===!0}function Se(e){return P.queryGeometry[ee(e)]===!0}function ge(e){return P.layerGeometry[e]===!0}function de(){return import("./geometryEngineJSON.54e2870f.js")}function Pe(e,t,n,i,r){if(G(t)&&n==="esriGeometryPoint"&&(e==="esriSpatialRelIntersects"||e==="esriSpatialRelContains")){const s=M(new p,t,!1,!1);return Promise.resolve(o=>fe(s,!1,!1,o))}if(G(t)&&n==="esriGeometryMultipoint"){const s=M(new p,t,!1,!1);if(e==="esriSpatialRelContains")return Promise.resolve(o=>pe(s,!1,!1,o,i,r))}if(y(t)&&n==="esriGeometryPoint"&&(e==="esriSpatialRelIntersects"||e==="esriSpatialRelContains"))return Promise.resolve(s=>Q(t,R(n,i,r,s)));if(y(t)&&n==="esriGeometryMultipoint"&&e==="esriSpatialRelContains")return Promise.resolve(s=>X(t,R(n,i,r,s)));if(y(t)&&e==="esriSpatialRelIntersects"){const s=ce(n);return Promise.resolve(o=>s(t,R(n,i,r,o)))}return de().then(s=>{const o=s[ye[e]].bind(null,t.spatialReference,t);return l=>o(R(n,i,r,l))})}async function be(e,t,n){const{spatialRel:i,geometry:r}=e;if(r){if(!Re(i))throw new $(N,"Unsupported query spatial relationship",{query:e});if(F(r.spatialReference)&&F(n)){if(!Se(r))throw new $(N,"Unsupported query geometry type",{query:e});if(!ge(t))throw new $(N,"Unsupported layer geometry type",{query:e});if(e.outSR)return w(e.geometry&&e.geometry.spatialReference,e.outSR)}}}function Me(e){if(y(e))return!0;if(G(e)){for(const t of e.rings)if(t.length!==5||t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1;return!0}return!1}export{Me as I,R as J,ve as O,Ie as P,E as U,oe as Z,be as a,we as n,$e as t,Pe as v,Ne as z};
