import{c as x,r as g,I as k,p as U,o as $,a3 as n,N as B,M as D,O as K,a7 as J,C as q,g as z,k as G,t as s,i as t,J as w,l,w as i,A as v,y as O,z as X,L as Y,D as V,K as E,n as H}from"./vendor.c6be4c00.js";/* empty css                 */import{_ as Q,c as W,d as Z,l as ee,e as se,f as oe}from"./index.a0863940.js";const I=p=>(O("data-v-120c6c25"),p=p(),X(),p),te={class:"login-container"},ae=I(()=>s("div",{class:"login-bg"},null,-1)),ne={class:"login-wrapper"},le={class:"login__header"},re=["src"],ie={class:"title"},ce=I(()=>s("div",{class:"sub-english"},"XLONG JILIDUN MAP MANAGEMENT SYSTEM",-1)),de={class:"login__content"},ue={class:"remember-wrapper"},pe=v("\u8BB0\u4F4F\u5BC6\u7801"),_e=v("\u767B\u5F55"),me={class:"copyright"},ge={class:"link",target:"blank",href:"https://github.com/xLong1029"},ve=v(" All Rights Reserved. "),fe={setup(p){const{showDevMessage:N,store:c,toPage:S}=W(),{validForm:C}=oe(),h=x(()=>c.getters.sysTitle),d=g(!1),M="2021",R=x(()=>c.getters.companyName),y=g(),o=k({username:"",password:""}),u=g(!1),_=g(!1),j=k({username:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}]});U(()=>d.value,(m,e)=>{console.log(m,e),!m&&n.get("username")&&(n.remove("username"),n.remove("password"))}),$(()=>{n.get("username")&&(o.username=n.get("username"),o.password=Z(n.get("password")),d.value=!0)});const f=async()=>{if(await C(y.value,"\u4FE1\u606F\u586B\u5199\u6709\u8BEF\uFF0C\u8BF7\u68C0\u67E5"))try{u.value=!0;const e=Y(o),r=await c.dispatch("user/login",e);d.value&&(n.set("username",o.username,{expires:7}),n.set("password",se(o.password),{expires:7})),await c.dispatch("permission/generateRoutes",r.roles),c.commit("user/SET_USER",r),V.success(`\u5C0A\u656C\u7684${r.nickName}\uFF0C\u6B22\u8FCE\u4F7F\u7528${h.value}`),u.value=!1,S("/map")}catch{V.error("\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u4E0D\u6B63\u786E"),u.value=!1}},A=()=>{N()},F=()=>{_.value=!_.value};return(m,e)=>{const r=B,b=D,L=K,P=J,T=q;return z(),G("div",te,[ae,s("div",ne,[s("div",le,[s("img",{src:t(ee),class:"logo"},null,8,re),s("div",ie,w(t(h)),1),ce]),s("div",de,[l(L,{model:t(o),rules:t(j),ref_key:"lofinForm",ref:y,"label-width":"0"},{default:i(()=>[l(b,{prop:"username"},{default:i(()=>[l(r,{class:"login__input",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D","prefix-icon":"el-icon-user",modelValue:t(o).username,"onUpdate:modelValue":e[0]||(e[0]=a=>t(o).username=a),onKeyup:e[1]||(e[1]=E(a=>f(),["enter"]))},null,8,["modelValue"])]),_:1}),l(b,{prop:"password"},{default:i(()=>[l(r,{class:"login__input",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801","prefix-icon":"el-icon-key",type:_.value?"text":"password",modelValue:t(o).password,"onUpdate:modelValue":e[2]||(e[2]=a=>t(o).password=a),onKeyup:e[3]||(e[3]=E(a=>f(),["enter"]))},{suffix:i(()=>[s("i",{onClick:F,class:H(["iconfont mr-5 pointer",_.value?"icon-kejian":"icon-bukejian"])},null,2)]),_:1},8,["type","modelValue"])]),_:1})]),_:1},8,["model","rules"]),s("div",ue,[l(P,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=a=>d.value=a),disabled:u.value},{default:i(()=>[pe]),_:1},8,["modelValue","disabled"]),s("a",{class:"forget-link",onClick:A},"\u5FD8\u8BB0\u5BC6\u7801?")]),l(T,{class:"login__btn",type:"primary",loading:u.value,onClick:e[5]||(e[5]=a=>f())},{default:i(()=>[_e]),_:1},8,["loading"])]),s("div",me,[v(" Copyright \xA9 "+w(M)+" "),s("a",ge,w(t(R)),1),ve])])])}}};var be=Q(fe,[["__scopeId","data-v-120c6c25"]]);export{be as default};
