var f=Object.defineProperty,g=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var l=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var c=(i,e,t)=>e in i?f(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,p=(i,e)=>{for(var t in e||(e={}))b.call(e,t)&&c(i,t,e[t]);if(l)for(var t of l(e))_.call(e,t)&&c(i,t,e[t]);return i},m=(i,e)=>g(i,u(e));import{b4 as j,e as T,i as w}from"./index.988b09cd.js";import{a as y}from"./WGLContainer.c4152aca.js";import{l as C}from"./LayerView2D.8eaa8439.js";import R from"./GroupLayerView.697902e4.js";import"./vendor.c6be4c00.js";import"./index.25aa0880.js";/* empty css              */import"./qrcode.0911187d.js";/* empty css                 */import"./brushes.0945eb3a.js";import"./definitions.21e97413.js";import"./Utils.56a5b8e8.js";import"./number.dfbabd3f.js";import"./programUtils.cffd2d5b.js";import"./GeometryUtils.ea8c8742.js";import"./MaterialKey.d5a4d0f6.js";import"./pixelUtils.5acf42e1.js";import"./Container.b0eab594.js";import"./EffectView.8c4917f2.js";class F extends y{constructor(){super(...arguments),this._lastWidth=0,this._lastHeight=0,this.requiresDedicatedFBO=!1}dispose(){this._renderTarget&&(this._renderTarget.dispose(),this._renderTarget=null)}doRender(e){const t=this.createRenderParams(e),{context:r,painter:s,profiler:a}=t;this._prevFBO=r.getBoundFramebufferObject(),a.recordContainerStart(this.name);const o=this._getFbo(t),d=s.getRenderTarget();r.bindFramebuffer(o),s.setRenderTarget(o),r.setDepthWriteEnabled(!0),r.setColorMask(!0,!0,!0,!0),r.setClearColor(0,0,0,0),r.setClearDepth(1),r.clear(r.gl.COLOR_BUFFER_BIT|r.gl.DEPTH_BUFFER_BIT),r.setDepthWriteEnabled(!1);for(const n of this.children)n.beforeRender(e);for(const n of this.children)n.processRender(t);for(const n of this.children)n.afterRender(e);s.setRenderTarget(d),r.bindFramebuffer(this._prevFBO),s.beforeRenderLayer(t,this._clippingInfos?255:0,this.computedOpacity),r.setStencilTestEnabled(!1),r.setStencilWriteMask(0),s.blitTexture(r,o.colorTexture,9728),s.compositeLayer(t,this.computedOpacity),a.recordContainerEnd()}createRenderParams(e){return m(p({},super.createRenderParams(e)),{blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:1})}_getFbo(e){const{context:t,painter:r}=e,{width:s,height:a}=t.getViewport();if(s!==this._lastWidth||a!==this._lastHeight)if(this._lastWidth=s,this._lastHeight=a,this._renderTarget)this._renderTarget.resize(s,a);else{const o={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:s,height:a},d={colorTarget:0,depthStencilTarget:3};this._renderTarget=new j(t,d,o,r.getSharedStencilBuffer())}return this._renderTarget}}let h=class extends C(R){constructor(){super(...arguments),this.container=new F}attach(){this._updateStageChildren(),this.handles.add(this.layerViews.on("after-changes",()=>this._updateStageChildren()),"grouplayerview2d")}detach(){this.handles.remove("grouplayerview2d"),this.container.removeAllChildren()}update(i){}moveStart(){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((i,e)=>this.container.addChildAt(i.container,e))}};h=T([w("esri.views.2d.layers.GroupLayerView2D")],h);const z=h;export{z as default};
