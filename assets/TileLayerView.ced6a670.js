import{aY as c,aZ as m,a_ as h,c5 as n,c7 as d,b1 as f,f_ as v}from"./vendor.47ccae81.js";const F=p=>{let a=class extends p{async fetchPopupFeatures(i,l){const{layer:r}=this;if(!i)return Promise.reject(new n("tilelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:r}));if(r.type!=="tile")return Promise.reject(new n("tilelayerview:fetchPopupFeatures","Layer type should be 'tile'",{type:r.type}));const o=this.get("view.scale"),u=r.allSublayers.toArray().filter(e=>{const t=e.minScale===0||o<=e.minScale,s=e.maxScale===0||o>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&t&&s});return d(u.map(async e=>{const t=e.createQuery(),s=f(l)?l.event:null,y=v({renderer:e.renderer,event:s});return t.geometry=this.createFetchPopupFeaturesQueryGeometry(i,y),t.outFields=await e.popupTemplate.getRequiredFields(),(await e.queryFeatures(t)).features})).then(e=>[].concat(...e.map(t=>t.value).filter(Boolean)))}};return c([m()],a.prototype,"layer",void 0),a=c([h("esri.layers.mixins.TileLayerView")],a),a};export{F as i};
